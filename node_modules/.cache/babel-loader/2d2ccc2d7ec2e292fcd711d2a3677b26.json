{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _qs = require(\"qs\");\n\nvar _deepmerge = _interopRequireDefault(require(\"deepmerge\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _actions = require(\"./actions\");\n\nvar _defaultSettings = _interopRequireDefault(require(\"./default-settings\"));\n\nvar _errors = require(\"./errors\");\n\nvar _initializer = _interopRequireDefault(require(\"./initializer\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n} // Set HTTP interceptors.\n\n\n(0, _initializer[\"default\"])();\n/**\n * Maps react-admin queries to a JSONAPI REST API\n *\n * @param {string} apiUrl the base URL for the JSONAPI\n * @param {Object} userSettings Settings to configure this client.\n *\n * @param {string} type Request type, e.g GET_LIST\n * @param {string} resource Resource name, e.g. \"posts\"\n * @param {Object} payload Request parameters. Depends on the request type\n * @returns {Promise} the Promise for a data response\n */\n\nvar _default = function _default(apiUrl) {\n  var userSettings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (type, resource, params) {\n    var url = '';\n    var settings = (0, _deepmerge[\"default\"])(_defaultSettings[\"default\"], userSettings);\n    var options = {\n      headers: settings.headers\n    };\n\n    switch (type) {\n      case _actions.GET_LIST:\n        {\n          var _params$pagination = params.pagination,\n              page = _params$pagination.page,\n              perPage = _params$pagination.perPage; // Create query with pagination params.\n\n          var query = {\n            'page[number]': page,\n            'page[size]': perPage\n          }; // Add all filter params to query.\n\n          Object.keys(params.filter || {}).forEach(function (key) {\n            query[\"filter[\".concat(key, \"]\")] = params.filter[key];\n          }); // Add sort parameter\n\n          if (params.sort && params.sort.field) {\n            var prefix = params.sort.order === 'ASC' ? '' : '-';\n            query.sort = \"\".concat(prefix).concat(params.sort.field);\n          }\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat((0, _qs.stringify)(query));\n          break;\n        }\n\n      case _actions.GET_ONE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n        break;\n\n      case _actions.CREATE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource);\n        options.method = 'POST';\n        options.data = JSON.stringify({\n          data: {\n            type: resource,\n            attributes: params.data\n          }\n        });\n        break;\n\n      case _actions.UPDATE:\n        {\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n          var attributes = params.data;\n          delete attributes.id;\n          var data = {\n            data: {\n              id: params.id,\n              type: resource,\n              attributes: attributes\n            }\n          };\n          options.method = settings.updateMethod;\n          options.data = JSON.stringify(data);\n          break;\n        }\n\n      case _actions.DELETE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n        options.method = 'DELETE';\n        break;\n\n      case _actions.GET_MANY:\n        {\n          var _query = (0, _qs.stringify)({\n            'filter[id]': params.ids\n          }, {\n            arrayFormat: settings.arrayFormat\n          });\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat(_query);\n          break;\n        }\n\n      case _actions.GET_MANY_REFERENCE:\n        {\n          var _params$pagination2 = params.pagination,\n              _page = _params$pagination2.page,\n              _perPage = _params$pagination2.perPage; // Create query with pagination params.\n\n          var _query2 = {\n            'page[number]': _page,\n            'page[size]': _perPage\n          }; // Add all filter params to query.\n\n          Object.keys(params.filter || {}).forEach(function (key) {\n            _query2[\"filter[\".concat(key, \"]\")] = params.filter[key];\n          }); // Add the reference id to the filter params.\n\n          _query2[\"filter[\".concat(params.target, \"]\")] = params.id; // Add sort parameter\n\n          if (params.sort && params.sort.field) {\n            var _prefix = params.sort.order === 'ASC' ? '' : '-';\n\n            _query2.sort = \"\".concat(_prefix).concat(params.sort.field);\n          }\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat((0, _qs.stringify)(_query2));\n          break;\n        }\n\n      default:\n        throw new _errors.NotImplementedError(\"Unsupported Data Provider request type \".concat(type));\n    }\n\n    return (0, _axios[\"default\"])(_objectSpread({\n      url: url\n    }, options)).then(function (response) {\n      var total; // For all collection requests get the total count.\n\n      if ([_actions.GET_LIST, _actions.GET_MANY, _actions.GET_MANY_REFERENCE].includes(type)) {\n        // When meta data and the 'total' setting is provided try\n        // to get the total count.\n        if (response.data.meta && settings.total) {\n          total = response.data.meta[settings.total];\n        } // Use the length of the data array as a fallback.\n\n\n        total = total || response.data.data.length;\n      }\n\n      switch (type) {\n        case _actions.GET_MANY:\n        case _actions.GET_LIST:\n          {\n            return {\n              data: response.data.data.map(function (value) {\n                return Object.assign({\n                  id: value.id\n                }, value.attributes);\n              }),\n              total: total\n            };\n          }\n\n        case _actions.GET_MANY_REFERENCE:\n          {\n            return {\n              data: response.data.data.map(function (value) {\n                return Object.assign({\n                  id: value.id\n                }, value.attributes);\n              }),\n              total: total\n            };\n          }\n\n        case _actions.GET_ONE:\n          {\n            var _response$data$data = response.data.data,\n                id = _response$data$data.id,\n                _attributes = _response$data$data.attributes;\n            return {\n              data: _objectSpread({\n                id: id\n              }, _attributes)\n            };\n          }\n\n        case _actions.CREATE:\n          {\n            var _response$data$data2 = response.data.data,\n                _id = _response$data$data2.id,\n                _attributes2 = _response$data$data2.attributes;\n            return {\n              data: _objectSpread({\n                id: _id\n              }, _attributes2)\n            };\n          }\n\n        case _actions.UPDATE:\n          {\n            var _response$data$data3 = response.data.data,\n                _id2 = _response$data$data3.id,\n                _attributes3 = _response$data$data3.attributes;\n            return {\n              data: _objectSpread({\n                id: _id2\n              }, _attributes3)\n            };\n          }\n\n        case _actions.DELETE:\n          {\n            return {\n              data: {\n                id: params.id\n              }\n            };\n          }\n\n        default:\n          throw new _errors.NotImplementedError(\"Unsupported Data Provider request type \".concat(type));\n      }\n    });\n  };\n};\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/mark/Documents/space-of-space-front/node_modules/ra-jsonapi-client/build/index.js"],"names":["Object","defineProperty","exports","value","_qs","require","_deepmerge","_interopRequireDefault","_axios","_actions","_defaultSettings","_errors","_initializer","obj","__esModule","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","configurable","writable","_default","apiUrl","userSettings","undefined","type","resource","params","url","settings","options","headers","GET_LIST","_params$pagination","pagination","page","perPage","query","concat","sort","field","prefix","order","stringify","GET_ONE","id","CREATE","method","data","JSON","attributes","UPDATE","updateMethod","DELETE","GET_MANY","_query","ids","arrayFormat","GET_MANY_REFERENCE","_params$pagination2","_page","_perPage","_query2","_prefix","NotImplementedError","then","response","total","includes","meta","map","assign","_response$data$data","_attributes","_response$data$data2","_id","_attributes2","_response$data$data3","_id2","_attributes3"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _qs = require(\"qs\");\n\nvar _deepmerge = _interopRequireDefault(require(\"deepmerge\"));\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _actions = require(\"./actions\");\n\nvar _defaultSettings = _interopRequireDefault(require(\"./default-settings\"));\n\nvar _errors = require(\"./errors\");\n\nvar _initializer = _interopRequireDefault(require(\"./initializer\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// Set HTTP interceptors.\n(0, _initializer[\"default\"])();\n/**\n * Maps react-admin queries to a JSONAPI REST API\n *\n * @param {string} apiUrl the base URL for the JSONAPI\n * @param {Object} userSettings Settings to configure this client.\n *\n * @param {string} type Request type, e.g GET_LIST\n * @param {string} resource Resource name, e.g. \"posts\"\n * @param {Object} payload Request parameters. Depends on the request type\n * @returns {Promise} the Promise for a data response\n */\n\nvar _default = function _default(apiUrl) {\n  var userSettings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return function (type, resource, params) {\n    var url = '';\n    var settings = (0, _deepmerge[\"default\"])(_defaultSettings[\"default\"], userSettings);\n    var options = {\n      headers: settings.headers\n    };\n\n    switch (type) {\n      case _actions.GET_LIST:\n        {\n          var _params$pagination = params.pagination,\n              page = _params$pagination.page,\n              perPage = _params$pagination.perPage; // Create query with pagination params.\n\n          var query = {\n            'page[number]': page,\n            'page[size]': perPage\n          }; // Add all filter params to query.\n\n          Object.keys(params.filter || {}).forEach(function (key) {\n            query[\"filter[\".concat(key, \"]\")] = params.filter[key];\n          }); // Add sort parameter\n\n          if (params.sort && params.sort.field) {\n            var prefix = params.sort.order === 'ASC' ? '' : '-';\n            query.sort = \"\".concat(prefix).concat(params.sort.field);\n          }\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat((0, _qs.stringify)(query));\n          break;\n        }\n\n      case _actions.GET_ONE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n        break;\n\n      case _actions.CREATE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource);\n        options.method = 'POST';\n        options.data = JSON.stringify({\n          data: {\n            type: resource,\n            attributes: params.data\n          }\n        });\n        break;\n\n      case _actions.UPDATE:\n        {\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n          var attributes = params.data;\n          delete attributes.id;\n          var data = {\n            data: {\n              id: params.id,\n              type: resource,\n              attributes: attributes\n            }\n          };\n          options.method = settings.updateMethod;\n          options.data = JSON.stringify(data);\n          break;\n        }\n\n      case _actions.DELETE:\n        url = \"\".concat(apiUrl, \"/\").concat(resource, \"/\").concat(params.id);\n        options.method = 'DELETE';\n        break;\n\n      case _actions.GET_MANY:\n        {\n          var _query = (0, _qs.stringify)({\n            'filter[id]': params.ids\n          }, {\n            arrayFormat: settings.arrayFormat\n          });\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat(_query);\n          break;\n        }\n\n      case _actions.GET_MANY_REFERENCE:\n        {\n          var _params$pagination2 = params.pagination,\n              _page = _params$pagination2.page,\n              _perPage = _params$pagination2.perPage; // Create query with pagination params.\n\n          var _query2 = {\n            'page[number]': _page,\n            'page[size]': _perPage\n          }; // Add all filter params to query.\n\n          Object.keys(params.filter || {}).forEach(function (key) {\n            _query2[\"filter[\".concat(key, \"]\")] = params.filter[key];\n          }); // Add the reference id to the filter params.\n\n          _query2[\"filter[\".concat(params.target, \"]\")] = params.id; // Add sort parameter\n\n          if (params.sort && params.sort.field) {\n            var _prefix = params.sort.order === 'ASC' ? '' : '-';\n\n            _query2.sort = \"\".concat(_prefix).concat(params.sort.field);\n          }\n\n          url = \"\".concat(apiUrl, \"/\").concat(resource, \"?\").concat((0, _qs.stringify)(_query2));\n          break;\n        }\n\n      default:\n        throw new _errors.NotImplementedError(\"Unsupported Data Provider request type \".concat(type));\n    }\n\n    return (0, _axios[\"default\"])(_objectSpread({\n      url: url\n    }, options)).then(function (response) {\n      var total; // For all collection requests get the total count.\n\n      if ([_actions.GET_LIST, _actions.GET_MANY, _actions.GET_MANY_REFERENCE].includes(type)) {\n        // When meta data and the 'total' setting is provided try\n        // to get the total count.\n        if (response.data.meta && settings.total) {\n          total = response.data.meta[settings.total];\n        } // Use the length of the data array as a fallback.\n\n\n        total = total || response.data.data.length;\n      }\n\n      switch (type) {\n        case _actions.GET_MANY:\n        case _actions.GET_LIST:\n          {\n            return {\n              data: response.data.data.map(function (value) {\n                return Object.assign({\n                  id: value.id\n                }, value.attributes);\n              }),\n              total: total\n            };\n          }\n\n        case _actions.GET_MANY_REFERENCE:\n          {\n            return {\n              data: response.data.data.map(function (value) {\n                return Object.assign({\n                  id: value.id\n                }, value.attributes);\n              }),\n              total: total\n            };\n          }\n\n        case _actions.GET_ONE:\n          {\n            var _response$data$data = response.data.data,\n                id = _response$data$data.id,\n                _attributes = _response$data$data.attributes;\n            return {\n              data: _objectSpread({\n                id: id\n              }, _attributes)\n            };\n          }\n\n        case _actions.CREATE:\n          {\n            var _response$data$data2 = response.data.data,\n                _id = _response$data$data2.id,\n                _attributes2 = _response$data$data2.attributes;\n            return {\n              data: _objectSpread({\n                id: _id\n              }, _attributes2)\n            };\n          }\n\n        case _actions.UPDATE:\n          {\n            var _response$data$data3 = response.data.data,\n                _id2 = _response$data$data3.id,\n                _attributes3 = _response$data$data3.attributes;\n            return {\n              data: _objectSpread({\n                id: _id2\n              }, _attributes3)\n            };\n          }\n\n        case _actions.DELETE:\n          {\n            return {\n              data: {\n                id: params.id\n              }\n            };\n          }\n\n        default:\n          throw new _errors.NotImplementedError(\"Unsupported Data Provider request type \".concat(type));\n      }\n    });\n  };\n};\n\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}